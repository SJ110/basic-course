计算机网络第三章——运输层

服务概述：为不同主机上运行的进程之间提供逻辑通信。再发送方，运输层接收到来自上层的报文转换为运输层分组，也就是通常所说的报文段.运输层为每块加上一个首部，再提交给网络层发送带目的地。重点在于网络层不检测分组的正确性，只负责传输，因此检测报文的正确与否应该再运输层进行。

运输层和网络层的区别：把运输层比作两个不同家庭里的孩子，而网络层则是一个家庭中的不同孩子，一个家庭中的小明负责收起自己家中的信件也负责发放，而信件要发送出去需要邮政服务，在这里我们可以把小明看作是运输层协议，而邮政服务看作是网络层协议。小明家里的兄妹则是主机中的不同进程。更进一步，信件上的文字则是来自于上层应用层的报文。

多路复用和多路分解：从源主机上接受报文并分为不同的数据段，为每一段装上一个套接字首部经运输层发送到网络层成为多路复用。而将运输层的报文段交付到正确的套接字成为多路分解。以上面例子：小明收到邮递员给自己的信件（信件全部都是小明和家里亲人的）这成为多路分解。
而小明收集家里亲人要寄出的信件再递交给邮递员成为多路复用。

面向链接的多路复用和多路分解：Tcp套接字是一个四元组，包含（源端口，目的端口，源ip和目的ip），当一个报文段到达目的主机时会进行匹配，如果tcp套接字包含的数据段中源端口或者源ip是不同的，则会被判定为该报文段来自不同的tcp套接字，通俗的说，就是这两个报文段来自不同的报文。（好像也不太对）。udp协议中只包含源端口和目的端口两个信息就不再多讲，这是一种无连接的数据传输。再提一点，端口是一个16bit的数据进行标识。
tcp的可靠数据传输协议和拥塞控制：

回退n步和选择重传用来解决流水传输中的差错问题。GBN:一般来说，窗口大小是序号大小的有1/2。当运输层发送的数据报到达接收方时，接受方会做出确认并返回确认信息给发送发，如果在规定时间内发送方没有收到响应或者收到的时接收方的错误响应信息，则会从新发送数据报，从发的起点是第一个未收到的数据报的序号。
选择重传：与之前的问题一样，发送方会选择接收方没收到的数据报进行重传，当接收方收到确认信息后放回确认给发送方。这样一来空间的消耗相对增加，因为数据报需要进行缓存，接收方收到失序数据后先不提交给上层应用层，而是再收到重传后的数据报得到有序报文再进行多路分解递交给上层。

TCP报文段结构：

https://www.cnblogs.com/feng9exe/p/8058891.html
首先是两个16bits的源端口和目的端口，用于多路复用和多路分解。
两个32bits的序号和确认号，用于实现tcp可靠数据传输服务。首部长度，4个bits位，事宜32bits位的tcp首部长度。后面六个bits的标志字段，2个字节的窗口字段，tcp一段根据设置的缓存空间大小确定自己接收窗口的大小。然后通知对方已确定对伐发送窗口上限。校验和字段2个字节 ：检验范围包括首部和数据。选项字段：，用户来规定最大长度的报文段MSS，之后是数据字段。

拥塞定义：过多的源发送了过多的数据，超过了网络的处理能力，这不同于流量控制。

tcp拥塞控制：方法1.每个发送方自动感知网络拥塞的程度，发送方根据感知的解惑限制外发的流量。tcp感知拥塞通过超时和连续收到3个冗余ack。
调节方式：

拥塞控制算法：1.加性增，乘性减，2.慢启动（初始速率低，但是增加快）3.对超时事件作出反应。
具体拥塞控制图的实现考试前再看看。
